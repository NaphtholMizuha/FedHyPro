True
{'data_name': 'imagenette', 'model_name': 'resnet18', 'algorithm': 'fedhypro', 'n_client': 10, 'n_round': 20, 'n_epoch': 3, 'device': 'cuda', 'lr': 0.01, 'he_rate': 0.1, 'repeat': 5, 'split': 'iid', 'save_path': './res', 'dp': {'eps': 0.5, 'delta': 1e-05, 'clip_thr': 10}, 'dynamic': {'enabled': True, 'punish': 0.975}, 'db': 'db/data.db'}
Running experiment resnet18-0.1*0.975-fedhypro_max-iid-0
Data fetched
Model fetched
path: ./temp/imagenette-c10-iid.npy
Loading partition from ./temp/imagenette-c10-iid.npy
Data splitted
start fedhypro
Start Training
Client 0 trained with time 13.22
Mask generated for client 0 with time 1.67
Client 1 trained with time 12.27
Mask generated for client 1 with time 1.54
Client 2 trained with time 11.23
Mask generated for client 2 with time 1.41
Client 3 trained with time 9.51
Mask generated for client 3 with time 1.46
Client 4 trained with time 10.32
Mask generated for client 4 with time 1.92
Client 5 trained with time 10.41
Mask generated for client 5 with time 1.66
Client 6 trained with time 10.12
Mask generated for client 6 with time 1.43
Client 7 trained with time 10.34
Mask generated for client 7 with time 1.94
Client 8 trained with time 11.11
Mask generated for client 8 with time 1.76
Client 9 trained with time 11.22
Mask generated for client 9 with time 1.74
Masks aggregated with time 7.58
Update generated with time 28.60
Update aggregated with time: 3.05
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Model distributed with time: 8.69
Round 1 Loss: 29149836541913636.0000, Acc: 0.0961
Client 0 trained with time 4.84
Mask generated for client 0 with time 1.41
Client 1 trained with time 4.64
Mask generated for client 1 with time 1.52
Client 2 trained with time 5.59
Mask generated for client 2 with time 1.48
Client 3 trained with time 5.75
Mask generated for client 3 with time 1.36
Client 4 trained with time 5.30
Mask generated for client 4 with time 1.51
Client 5 trained with time 5.34
Mask generated for client 5 with time 1.38
Client 6 trained with time 6.54
Mask generated for client 6 with time 1.52
Client 7 trained with time 7.01
Mask generated for client 7 with time 1.45
Client 8 trained with time 6.47
Mask generated for client 8 with time 1.34
Client 9 trained with time 8.00
Mask generated for client 9 with time 1.32
Masks aggregated with time 6.70
Update generated with time 31.27
Update aggregated with time: 3.41
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Model distributed with time: 14.97
Round 2 Loss: 43.4338, Acc: 0.0994
Client 0 trained with time 14.90
Mask generated for client 0 with time 1.34
Client 1 trained with time 14.05
Mask generated for client 1 with time 1.36
Client 2 trained with time 13.80
Mask generated for client 2 with time 1.40
Client 3 trained with time 12.25
Mask generated for client 3 with time 1.48
Client 4 trained with time 11.47
Mask generated for client 4 with time 1.53
Client 5 trained with time 11.99
Mask generated for client 5 with time 1.38
Client 6 trained with time 7.02
Mask generated for client 6 with time 1.62
Client 7 trained with time 6.34
Mask generated for client 7 with time 1.49
Client 8 trained with time 8.22
Mask generated for client 8 with time 1.23
Client 9 trained with time 7.00
Mask generated for client 9 with time 1.34
Masks aggregated with time 11.03
Update generated with time 36.16
Update aggregated with time: 4.41
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Model distributed with time: 22.91
Round 3 Loss: 5.7140, Acc: 0.1090
Client 0 trained with time 11.72
Mask generated for client 0 with time 2.21
Client 1 trained with time 10.22
Mask generated for client 1 with time 2.03
Client 2 trained with time 11.47
Mask generated for client 2 with time 1.84
Client 3 trained with time 11.18
Mask generated for client 3 with time 1.58
Client 4 trained with time 10.13
Mask generated for client 4 with time 2.80
Client 5 trained with time 8.29
Mask generated for client 5 with time 1.78
Client 6 trained with time 8.93
Mask generated for client 6 with time 1.33
Client 7 trained with time 8.32
Mask generated for client 7 with time 1.58
Client 8 trained with time 8.60
Mask generated for client 8 with time 1.45
Client 9 trained with time 7.82
Mask generated for client 9 with time 1.54
Masks aggregated with time 6.14
Update generated with time 30.72
Update aggregated with time: 3.42
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Model distributed with time: 20.38
Round 4 Loss: 4.4213, Acc: 0.1248
Client 0 trained with time 11.38
Mask generated for client 0 with time 2.67
Client 1 trained with time 11.37
Mask generated for client 1 with time 2.56
Client 2 trained with time 10.82
Mask generated for client 2 with time 2.68
Client 3 trained with time 11.30
Mask generated for client 3 with time 3.04
Client 4 trained with time 11.79
Mask generated for client 4 with time 2.87
Client 5 trained with time 11.15
Mask generated for client 5 with time 2.50
Client 6 trained with time 11.92
Mask generated for client 6 with time 2.91
Client 7 trained with time 10.81
Mask generated for client 7 with time 2.74
Client 8 trained with time 11.24
Mask generated for client 8 with time 2.52
Client 9 trained with time 11.28
Mask generated for client 9 with time 2.54
Masks aggregated with time 17.50
Update generated with time 60.05
Update aggregated with time: 7.18
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Model distributed with time: 31.47
Round 5 Loss: 3.9308, Acc: 0.1146
Client 0 trained with time 9.97
Mask generated for client 0 with time 1.99
Client 1 trained with time 10.63
Mask generated for client 1 with time 2.55
Client 2 trained with time 10.43
Mask generated for client 2 with time 1.98
Client 3 trained with time 10.84
Mask generated for client 3 with time 2.82
Client 4 trained with time 12.17
Mask generated for client 4 with time 2.97
Client 5 trained with time 11.81
Mask generated for client 5 with time 3.03
Client 6 trained with time 12.37
Mask generated for client 6 with time 3.12
Client 7 trained with time 11.53
Mask generated for client 7 with time 2.82
Client 8 trained with time 12.09
Mask generated for client 8 with time 2.77
Client 9 trained with time 11.67
Mask generated for client 9 with time 2.63
Masks aggregated with time 19.48
Update generated with time 70.24
Update aggregated with time: 7.15
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Model distributed with time: 38.02
Round 6 Loss: 3.6109, Acc: 0.1801
Client 0 trained with time 11.25
Mask generated for client 0 with time 1.92
Client 1 trained with time 11.61
Mask generated for client 1 with time 2.47
Client 2 trained with time 11.65
Mask generated for client 2 with time 2.42
Client 3 trained with time 11.19
Mask generated for client 3 with time 2.51
Client 4 trained with time 12.59
Mask generated for client 4 with time 2.80
Client 5 trained with time 12.18
Mask generated for client 5 with time 2.49
Client 6 trained with time 12.19
Mask generated for client 6 with time 2.52
Client 7 trained with time 11.94
Mask generated for client 7 with time 2.23
Client 8 trained with time 12.66
Mask generated for client 8 with time 2.48
Client 9 trained with time 11.83
Mask generated for client 9 with time 3.33
Masks aggregated with time 19.61
Update generated with time 67.67
Update aggregated with time: 6.83
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Model distributed with time: 37.90
Round 7 Loss: 2.4945, Acc: 0.2591
Client 0 trained with time 11.06
Mask generated for client 0 with time 2.86
Client 1 trained with time 11.39
Mask generated for client 1 with time 2.66
Client 2 trained with time 11.57
Mask generated for client 2 with time 2.58
Client 3 trained with time 11.92
Mask generated for client 3 with time 2.61
Client 4 trained with time 12.42
Mask generated for client 4 with time 2.78
Client 5 trained with time 12.12
Mask generated for client 5 with time 2.72
Client 6 trained with time 11.85
Mask generated for client 6 with time 2.84
Client 7 trained with time 11.82
Mask generated for client 7 with time 2.79
Client 8 trained with time 12.30
Mask generated for client 8 with time 2.70
Client 9 trained with time 12.17
Mask generated for client 9 with time 3.24
Masks aggregated with time 20.16
Update generated with time 66.15
Update aggregated with time: 6.83
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Model distributed with time: 34.31
Round 8 Loss: 2.7497, Acc: 0.2204
Client 0 trained with time 9.48
Mask generated for client 0 with time 1.83
Client 1 trained with time 9.52
Mask generated for client 1 with time 1.78
Client 2 trained with time 10.43
Mask generated for client 2 with time 2.16
Client 3 trained with time 9.98
Mask generated for client 3 with time 2.06
Client 4 trained with time 11.28
Mask generated for client 4 with time 2.70
Client 5 trained with time 11.08
Mask generated for client 5 with time 2.70
Client 6 trained with time 11.34
Mask generated for client 6 with time 2.14
Client 7 trained with time 12.22
Mask generated for client 7 with time 2.53
Client 8 trained with time 12.46
Mask generated for client 8 with time 2.76
Client 9 trained with time 12.43
Mask generated for client 9 with time 2.71
Masks aggregated with time 18.76
Update generated with time 64.30
Update aggregated with time: 6.06
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Model distributed with time: 34.97
Round 9 Loss: 2.2042, Acc: 0.3175
Client 0 trained with time 10.53
Mask generated for client 0 with time 1.92
Client 1 trained with time 9.51
Mask generated for client 1 with time 1.60
Client 2 trained with time 9.53
Mask generated for client 2 with time 2.06
Client 3 trained with time 10.05
Mask generated for client 3 with time 2.59
Client 4 trained with time 10.14
Mask generated for client 4 with time 2.08
Client 5 trained with time 10.91
Mask generated for client 5 with time 2.39
Client 6 trained with time 11.47
Mask generated for client 6 with time 2.35
Client 7 trained with time 10.86
Mask generated for client 7 with time 2.85
Client 8 trained with time 12.09
Mask generated for client 8 with time 2.65
Client 9 trained with time 11.15
Mask generated for client 9 with time 2.67
Masks aggregated with time 17.29
Update generated with time 60.82
Update aggregated with time: 5.36
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Model distributed with time: 34.32
Round 10 Loss: 2.1839, Acc: 0.3366
Client 0 trained with time 10.87
Mask generated for client 0 with time 2.29
Client 1 trained with time 10.74
Mask generated for client 1 with time 2.39
Client 2 trained with time 11.14
Mask generated for client 2 with time 2.70
Client 3 trained with time 10.35
Mask generated for client 3 with time 2.42
Client 4 trained with time 10.99
Mask generated for client 4 with time 2.30
Client 5 trained with time 11.35
Mask generated for client 5 with time 2.64
Client 6 trained with time 11.47
Mask generated for client 6 with time 2.78
Client 7 trained with time 10.71
Mask generated for client 7 with time 2.28
Client 8 trained with time 10.94
Mask generated for client 8 with time 2.66
Client 9 trained with time 11.34
Mask generated for client 9 with time 2.60
Masks aggregated with time 16.07
Update generated with time 51.17
Update aggregated with time: 4.28
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Model distributed with time: 29.57
Round 11 Loss: 1.8028, Acc: 0.4153
Client 0 trained with time 11.58
Mask generated for client 0 with time 2.45
Client 1 trained with time 12.00
Mask generated for client 1 with time 2.95
Client 2 trained with time 10.93
Mask generated for client 2 with time 2.30
Client 3 trained with time 11.97
Mask generated for client 3 with time 1.75
Client 4 trained with time 10.48
Mask generated for client 4 with time 1.89
Client 5 trained with time 11.21
Mask generated for client 5 with time 2.32
Client 6 trained with time 11.40
Mask generated for client 6 with time 2.04
Client 7 trained with time 10.95
Mask generated for client 7 with time 2.58
Client 8 trained with time 11.66
Mask generated for client 8 with time 2.46
Client 9 trained with time 11.41
Mask generated for client 9 with time 2.80
Masks aggregated with time 17.14
Update generated with time 51.76
Update aggregated with time: 5.34
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Model distributed with time: 27.05
Round 12 Loss: 1.8979, Acc: 0.3707
Client 0 trained with time 11.12
Mask generated for client 0 with time 2.47
Client 1 trained with time 11.07
Mask generated for client 1 with time 1.94
Client 2 trained with time 12.19
Mask generated for client 2 with time 2.92
Client 3 trained with time 11.82
Mask generated for client 3 with time 2.72
Client 4 trained with time 12.58
Mask generated for client 4 with time 3.35
Client 5 trained with time 11.90
Mask generated for client 5 with time 2.90
Client 6 trained with time 12.49
Mask generated for client 6 with time 2.66
Client 7 trained with time 12.66
Mask generated for client 7 with time 1.84
Client 8 trained with time 11.57
Mask generated for client 8 with time 2.26
Client 9 trained with time 10.94
Mask generated for client 9 with time 1.79
Masks aggregated with time 14.28
Update generated with time 46.71
Update aggregated with time: 4.50
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Model distributed with time: 25.54
Round 13 Loss: 1.8150, Acc: 0.3730
Client 0 trained with time 10.44
Mask generated for client 0 with time 2.10
Client 1 trained with time 11.02
Mask generated for client 1 with time 1.32
Client 2 trained with time 8.93
Mask generated for client 2 with time 1.88
Client 3 trained with time 10.24
Mask generated for client 3 with time 1.55
Client 4 trained with time 10.28
Mask generated for client 4 with time 2.09
Client 5 trained with time 11.33
Mask generated for client 5 with time 1.69
Client 6 trained with time 11.27
Mask generated for client 6 with time 2.21
Client 7 trained with time 12.54
Mask generated for client 7 with time 2.59
Client 8 trained with time 12.78
Mask generated for client 8 with time 1.54
Client 9 trained with time 11.41
Mask generated for client 9 with time 2.07
Masks aggregated with time 17.84
Update generated with time 53.32
Update aggregated with time: 5.14
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Model distributed with time: 30.12
Round 14 Loss: 2.1650, Acc: 0.3307
Client 0 trained with time 8.26
Mask generated for client 0 with time 1.60
Client 1 trained with time 8.41
Mask generated for client 1 with time 1.54
Client 2 trained with time 8.33
Mask generated for client 2 with time 1.40
Client 3 trained with time 9.65
Mask generated for client 3 with time 1.84
Client 4 trained with time 10.54
Mask generated for client 4 with time 1.52
Client 5 trained with time 10.35
Mask generated for client 5 with time 2.07
Client 6 trained with time 11.68
Mask generated for client 6 with time 2.10
Client 7 trained with time 12.58
Mask generated for client 7 with time 2.29
Client 8 trained with time 11.90
Mask generated for client 8 with time 2.38
Client 9 trained with time 13.37
Mask generated for client 9 with time 2.43
Masks aggregated with time 20.58
Update generated with time 58.97
Update aggregated with time: 4.88
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Model distributed with time: 31.56
Round 15 Loss: 1.5012, Acc: 0.5073
Client 0 trained with time 9.75
Mask generated for client 0 with time 1.60
Client 1 trained with time 10.38
Mask generated for client 1 with time 1.72
Client 2 trained with time 9.33
Mask generated for client 2 with time 1.36
Client 3 trained with time 9.36
Mask generated for client 3 with time 1.38
Client 4 trained with time 10.28
Mask generated for client 4 with time 1.36
Client 5 trained with time 9.54
Mask generated for client 5 with time 1.74
Client 6 trained with time 10.82
Mask generated for client 6 with time 1.82
Client 7 trained with time 11.01
Mask generated for client 7 with time 1.48
Client 8 trained with time 10.59
Mask generated for client 8 with time 1.85
Client 9 trained with time 11.32
Mask generated for client 9 with time 1.49
Masks aggregated with time 19.08
Update generated with time 57.13
Update aggregated with time: 5.15
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Model distributed with time: 33.14
Round 16 Loss: 1.8022, Acc: 0.4316
Client 0 trained with time 10.75
Mask generated for client 0 with time 1.84
Client 1 trained with time 10.47
Mask generated for client 1 with time 1.87
Client 2 trained with time 10.11
Mask generated for client 2 with time 1.73
Client 3 trained with time 9.58
Mask generated for client 3 with time 1.83
Client 4 trained with time 9.77
Mask generated for client 4 with time 1.71
Client 5 trained with time 9.70
Mask generated for client 5 with time 1.36
Client 6 trained with time 9.52
Mask generated for client 6 with time 1.76
Client 7 trained with time 9.88
Mask generated for client 7 with time 2.03
Client 8 trained with time 10.58
Mask generated for client 8 with time 2.24
Client 9 trained with time 10.88
Mask generated for client 9 with time 2.00
Masks aggregated with time 16.82
Update generated with time 55.60
Update aggregated with time: 5.22
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Model distributed with time: 32.57
Round 17 Loss: 1.6169, Acc: 0.4703
Client 0 trained with time 10.83
Mask generated for client 0 with time 1.83
Client 1 trained with time 10.50
Mask generated for client 1 with time 1.36
Client 2 trained with time 10.25
Mask generated for client 2 with time 1.67
Client 3 trained with time 9.95
Mask generated for client 3 with time 1.61
Client 4 trained with time 9.94
Mask generated for client 4 with time 2.08
Client 5 trained with time 9.95
Mask generated for client 5 with time 2.09
Client 6 trained with time 9.62
Mask generated for client 6 with time 2.07
Client 7 trained with time 10.16
Mask generated for client 7 with time 2.08
Client 8 trained with time 9.66
Mask generated for client 8 with time 1.51
Client 9 trained with time 10.61
Mask generated for client 9 with time 2.63
Masks aggregated with time 17.45
Update generated with time 52.08
Update aggregated with time: 5.42
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Model distributed with time: 31.14
Round 18 Loss: 1.6973, Acc: 0.4550
Client 0 trained with time 10.60
Mask generated for client 0 with time 1.94
Client 1 trained with time 10.76
Mask generated for client 1 with time 2.09
Client 2 trained with time 10.41
Mask generated for client 2 with time 1.69
Client 3 trained with time 10.13
Mask generated for client 3 with time 1.92
Client 4 trained with time 9.95
Mask generated for client 4 with time 1.28
Client 5 trained with time 10.17
Mask generated for client 5 with time 1.71
Client 6 trained with time 9.94
Mask generated for client 6 with time 1.69
Client 7 trained with time 9.83
Mask generated for client 7 with time 1.78
Client 8 trained with time 9.91
Mask generated for client 8 with time 1.83
Client 9 trained with time 9.75
Mask generated for client 9 with time 1.79
Masks aggregated with time 16.54
Update generated with time 47.01
Update aggregated with time: 4.74
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Model distributed with time: 30.99
Round 19 Loss: 1.4809, Acc: 0.5254
Client 0 trained with time 11.49
Mask generated for client 0 with time 2.17
Client 1 trained with time 11.66
Mask generated for client 1 with time 2.21
Client 2 trained with time 10.96
Mask generated for client 2 with time 1.84
Client 3 trained with time 9.62
Mask generated for client 3 with time 1.58
Client 4 trained with time 10.37
Mask generated for client 4 with time 2.22
Client 5 trained with time 10.51
Mask generated for client 5 with time 1.93
Client 6 trained with time 10.91
Mask generated for client 6 with time 1.57
Client 7 trained with time 9.78
Mask generated for client 7 with time 1.93
Client 8 trained with time 9.38
Mask generated for client 8 with time 2.49
Client 9 trained with time 9.84
Mask generated for client 9 with time 2.18
Masks aggregated with time 16.48
Update generated with time 48.96
Update aggregated with time: 4.50
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Model distributed with time: 30.53
Round 20 Loss: 1.8974, Acc: 0.4082
{'data_name': 'imagenette', 'model_name': 'resnet18', 'algorithm': 'fedhypro', 'n_client': 10, 'n_round': 20, 'n_epoch': 3, 'device': 'cuda', 'lr': 0.01, 'he_rate': 0.1, 'repeat': 5, 'split': 'iid', 'save_path': './res', 'dp': {'eps': 0.5, 'delta': 1e-05, 'clip_thr': 10}, 'dynamic': {'enabled': True, 'punish': 0.975}, 'db': 'db/data.db'}
Running experiment resnet18-0.1*0.975-fedhypro_max-iid-1
Data fetched
Model fetched
path: ./temp/imagenette-c10-iid.npy
Loading partition from ./temp/imagenette-c10-iid.npy
Data splitted
start fedhypro
Start Training
Client 0 trained with time 11.53
Mask generated for client 0 with time 2.17
Client 1 trained with time 10.66
Mask generated for client 1 with time 1.50
Client 2 trained with time 10.26
Mask generated for client 2 with time 1.80
Client 3 trained with time 9.41
Mask generated for client 3 with time 1.95
Client 4 trained with time 9.59
Mask generated for client 4 with time 1.59
Client 5 trained with time 8.84
Mask generated for client 5 with time 1.55
Client 6 trained with time 8.99
Mask generated for client 6 with time 1.85
Client 7 trained with time 9.39
Mask generated for client 7 with time 1.80
Client 8 trained with time 9.26
Mask generated for client 8 with time 1.40
Client 9 trained with time 9.20
Mask generated for client 9 with time 1.89
Masks aggregated with time 14.61
Update generated with time 58.24
Update aggregated with time: 6.30
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Model distributed with time: 40.44
Round 1 Loss: 22606754358399408.0000, Acc: 0.1068
Client 0 trained with time 11.34
Mask generated for client 0 with time 2.24
Client 1 trained with time 11.08
Mask generated for client 1 with time 1.99
Client 2 trained with time 10.54
Mask generated for client 2 with time 1.70
Client 3 trained with time 9.99
Mask generated for client 3 with time 1.54
Client 4 trained with time 10.94
Mask generated for client 4 with time 1.37
Client 5 trained with time 10.23
Mask generated for client 5 with time 1.44
Client 6 trained with time 10.57
Mask generated for client 6 with time 2.34
Client 7 trained with time 9.95
Mask generated for client 7 with time 1.91
Client 8 trained with time 10.16
Mask generated for client 8 with time 2.61
Client 9 trained with time 10.05
Mask generated for client 9 with time 2.27
Masks aggregated with time 11.99
Update generated with time 43.45
Update aggregated with time: 4.35
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Model distributed with time: 27.76
Round 2 Loss: 93.3915, Acc: 0.1068
Client 0 trained with time 11.49
Mask generated for client 0 with time 3.32
Client 1 trained with time 10.31
Mask generated for client 1 with time 1.77
Client 2 trained with time 9.95
Mask generated for client 2 with time 1.88
Client 3 trained with time 11.71
Mask generated for client 3 with time 1.57
Client 4 trained with time 11.67
Mask generated for client 4 with time 1.26
Client 5 trained with time 10.31
Mask generated for client 5 with time 2.02
Client 6 trained with time 10.57
Mask generated for client 6 with time 1.95
Client 7 trained with time 11.26
Mask generated for client 7 with time 1.69
Client 8 trained with time 9.54
Mask generated for client 8 with time 1.50
Client 9 trained with time 10.11
Mask generated for client 9 with time 2.22
Masks aggregated with time 11.88
Update generated with time 50.38
Update aggregated with time: 5.16
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Model distributed with time: 26.80
Round 3 Loss: 4.8728, Acc: 0.1022
Client 0 trained with time 11.38
Mask generated for client 0 with time 2.36
Client 1 trained with time 12.34
Mask generated for client 1 with time 3.01
Client 2 trained with time 13.32
Mask generated for client 2 with time 2.40
Client 3 trained with time 13.20
Mask generated for client 3 with time 2.69
Client 4 trained with time 13.37
Mask generated for client 4 with time 2.81
Client 5 trained with time 12.68
Mask generated for client 5 with time 3.17
Client 6 trained with time 13.12
Mask generated for client 6 with time 2.80
Client 7 trained with time 12.59
Mask generated for client 7 with time 2.97
Client 8 trained with time 12.13
Mask generated for client 8 with time 2.72
Client 9 trained with time 11.59
Mask generated for client 9 with time 2.27
Masks aggregated with time 17.15
Update generated with time 63.03
Update aggregated with time: 6.26
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Model distributed with time: 30.61
Round 4 Loss: 5.0049, Acc: 0.1411
Client 0 trained with time 11.04
Mask generated for client 0 with time 2.54
Client 1 trained with time 12.66
Mask generated for client 1 with time 2.64
Client 2 trained with time 12.42
Mask generated for client 2 with time 3.26
Client 3 trained with time 12.54
Mask generated for client 3 with time 3.17
Client 4 trained with time 13.07
Mask generated for client 4 with time 2.85
Client 5 trained with time 12.45
Mask generated for client 5 with time 2.61
Client 6 trained with time 11.96
Mask generated for client 6 with time 2.55
Client 7 trained with time 12.55
Mask generated for client 7 with time 2.01
Client 8 trained with time 11.84
Mask generated for client 8 with time 1.96
Client 9 trained with time 12.05
Mask generated for client 9 with time 2.64
Masks aggregated with time 19.42
Update generated with time 66.30
Update aggregated with time: 6.76
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Model distributed with time: 37.27
Round 5 Loss: 3.1155, Acc: 0.1997
Client 0 trained with time 11.62
Mask generated for client 0 with time 2.15
Client 1 trained with time 11.32
Mask generated for client 1 with time 2.30
Client 2 trained with time 11.50
Mask generated for client 2 with time 2.20
Client 3 trained with time 11.63
Mask generated for client 3 with time 2.24
Client 4 trained with time 11.40
Mask generated for client 4 with time 2.05
Client 5 trained with time 11.36
Mask generated for client 5 with time 1.82
Client 6 trained with time 11.51
Mask generated for client 6 with time 2.69
Client 7 trained with time 11.38
Mask generated for client 7 with time 1.95
Client 8 trained with time 10.63
Mask generated for client 8 with time 2.41
Client 9 trained with time 10.39
Mask generated for client 9 with time 2.33
Masks aggregated with time 16.36
Update generated with time 59.89
Update aggregated with time: 6.12
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Model distributed with time: 38.50
Round 6 Loss: 2.6589, Acc: 0.2515
Client 0 trained with time 11.63
Mask generated for client 0 with time 2.27
Client 1 trained with time 11.58
Mask generated for client 1 with time 2.13
Client 2 trained with time 11.24
Mask generated for client 2 with time 2.34
Client 3 trained with time 11.46
Mask generated for client 3 with time 2.14
Client 4 trained with time 11.41
Mask generated for client 4 with time 2.57
Client 5 trained with time 12.29
Mask generated for client 5 with time 2.22
Client 6 trained with time 11.84
Mask generated for client 6 with time 2.56
Client 7 trained with time 11.40
Mask generated for client 7 with time 3.04
Client 8 trained with time 11.14
Mask generated for client 8 with time 2.28
Client 9 trained with time 11.09
Mask generated for client 9 with time 2.12
Masks aggregated with time 16.19
Update generated with time 54.73
Update aggregated with time: 5.77
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Model distributed with time: 33.20
Round 7 Loss: 2.7998, Acc: 0.2820
Client 0 trained with time 10.97
Mask generated for client 0 with time 2.44
Client 1 trained with time 11.61
Mask generated for client 1 with time 2.53
Client 2 trained with time 11.39
Mask generated for client 2 with time 2.49
Client 3 trained with time 11.88
Mask generated for client 3 with time 2.61
Client 4 trained with time 12.09
Mask generated for client 4 with time 2.25
Client 5 trained with time 12.32
Mask generated for client 5 with time 2.12
Client 6 trained with time 12.74
Mask generated for client 6 with time 2.82
Client 7 trained with time 13.15
Mask generated for client 7 with time 2.94
Client 8 trained with time 12.17
Mask generated for client 8 with time 2.64
Client 9 trained with time 11.86
Mask generated for client 9 with time 2.73
Masks aggregated with time 17.03
Update generated with time 60.25
Update aggregated with time: 5.93
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Model distributed with time: 33.56
Round 8 Loss: 2.2460, Acc: 0.2902
Client 0 trained with time 9.98
Mask generated for client 0 with time 1.99
Client 1 trained with time 9.74
Mask generated for client 1 with time 2.16
Client 2 trained with time 10.47
Mask generated for client 2 with time 1.91
Client 3 trained with time 9.75
Mask generated for client 3 with time 1.96
Client 4 trained with time 11.71
Mask generated for client 4 with time 2.23
Client 5 trained with time 12.56
Mask generated for client 5 with time 2.52
Client 6 trained with time 12.16
Mask generated for client 6 with time 2.34
Client 7 trained with time 12.50
Mask generated for client 7 with time 2.77
Client 8 trained with time 12.89
Mask generated for client 8 with time 2.57
Client 9 trained with time 12.08
Mask generated for client 9 with time 1.72
Masks aggregated with time 19.23
Update generated with time 61.28
Update aggregated with time: 6.30
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Model distributed with time: 35.47
Round 9 Loss: 1.8772, Acc: 0.3850
Client 0 trained with time 9.70
Mask generated for client 0 with time 2.48
Client 1 trained with time 9.21
Mask generated for client 1 with time 1.61
Client 2 trained with time 9.74
Mask generated for client 2 with time 1.77
Client 3 trained with time 9.93
Mask generated for client 3 with time 2.17
Client 4 trained with time 10.44
Mask generated for client 4 with time 1.66
Client 5 trained with time 10.53
Mask generated for client 5 with time 1.85
Client 6 trained with time 9.93
Mask generated for client 6 with time 2.21
Client 7 trained with time 10.22
Mask generated for client 7 with time 2.95
Client 8 trained with time 12.07
Mask generated for client 8 with time 2.04
Client 9 trained with time 10.92
Mask generated for client 9 with time 2.41
Masks aggregated with time 18.67
Update generated with time 57.92
Update aggregated with time: 5.31
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Model distributed with time: 32.19
Round 10 Loss: 3.0065, Acc: 0.2805
Client 0 trained with time 9.53
Mask generated for client 0 with time 1.92
Client 1 trained with time 10.16
Mask generated for client 1 with time 2.37
Client 2 trained with time 10.23
Mask generated for client 2 with time 1.52
Client 3 trained with time 9.93
Mask generated for client 3 with time 1.86
Client 4 trained with time 8.37
Mask generated for client 4 with time 1.66
Client 5 trained with time 9.14
Mask generated for client 5 with time 1.75
Client 6 trained with time 8.96
Mask generated for client 6 with time 1.97
Client 7 trained with time 9.24
Mask generated for client 7 with time 1.95
Client 8 trained with time 9.63
Mask generated for client 8 with time 1.82
Client 9 trained with time 9.78
Mask generated for client 9 with time 2.33
Masks aggregated with time 13.59
Update generated with time 49.22
Update aggregated with time: 5.85
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Model distributed with time: 33.56
Round 11 Loss: 1.9570, Acc: 0.3931
Client 0 trained with time 10.53
Mask generated for client 0 with time 1.19
Client 1 trained with time 11.07
Mask generated for client 1 with time 1.28
Client 2 trained with time 10.46
Mask generated for client 2 with time 1.35
Client 3 trained with time 9.83
Mask generated for client 3 with time 1.60
Client 4 trained with time 10.66
Mask generated for client 4 with time 1.62
Client 5 trained with time 10.00
Mask generated for client 5 with time 1.40
Client 6 trained with time 10.38
Mask generated for client 6 with time 2.00
Client 7 trained with time 9.92
Mask generated for client 7 with time 1.91
Client 8 trained with time 10.89
Mask generated for client 8 with time 2.25
Client 9 trained with time 10.08
Mask generated for client 9 with time 2.11
Masks aggregated with time 15.94
Update generated with time 50.61
Update aggregated with time: 4.48
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Model distributed with time: 28.08
Round 12 Loss: 1.8454, Acc: 0.4104
Client 0 trained with time 12.67
Mask generated for client 0 with time 2.52
Client 1 trained with time 12.75
Mask generated for client 1 with time 2.24
Client 2 trained with time 11.71
Mask generated for client 2 with time 2.06
Client 3 trained with time 10.26
Mask generated for client 3 with time 1.80
Client 4 trained with time 10.35
Mask generated for client 4 with time 2.16
Client 5 trained with time 10.17
Mask generated for client 5 with time 1.83
Client 6 trained with time 10.28
Mask generated for client 6 with time 1.64
Client 7 trained with time 10.38
Mask generated for client 7 with time 2.09
Client 8 trained with time 10.09
Mask generated for client 8 with time 1.65
Client 9 trained with time 10.44
Mask generated for client 9 with time 1.97
Masks aggregated with time 15.22
Update generated with time 48.71
Update aggregated with time: 4.94
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Model distributed with time: 28.38
Round 13 Loss: 1.9245, Acc: 0.3824
Client 0 trained with time 12.30
Mask generated for client 0 with time 2.06
Client 1 trained with time 12.46
Mask generated for client 1 with time 2.32
Client 2 trained with time 12.34
Mask generated for client 2 with time 1.90
Client 3 trained with time 11.81
Mask generated for client 3 with time 1.93
Client 4 trained with time 11.23
Mask generated for client 4 with time 2.13
Client 5 trained with time 11.62
Mask generated for client 5 with time 2.01
Client 6 trained with time 11.25
Mask generated for client 6 with time 2.18
Client 7 trained with time 11.08
Mask generated for client 7 with time 2.13
Client 8 trained with time 10.61
Mask generated for client 8 with time 1.53
Client 9 trained with time 9.88
Mask generated for client 9 with time 2.39
Masks aggregated with time 14.84
Update generated with time 49.55
Update aggregated with time: 5.24
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Model distributed with time: 28.89
Round 14 Loss: 1.9292, Acc: 0.4087
Client 0 trained with time 11.42
Mask generated for client 0 with time 2.48
Client 1 trained with time 11.13
Mask generated for client 1 with time 2.38
Client 2 trained with time 11.84
Mask generated for client 2 with time 1.84
Client 3 trained with time 12.42
Mask generated for client 3 with time 2.76
Client 4 trained with time 11.69
Mask generated for client 4 with time 2.99
Client 5 trained with time 11.48
Mask generated for client 5 with time 2.57
Client 6 trained with time 11.25
Mask generated for client 6 with time 2.11
Client 7 trained with time 10.64
Mask generated for client 7 with time 2.48
Client 8 trained with time 11.36
Mask generated for client 8 with time 2.09
Client 9 trained with time 11.33
Mask generated for client 9 with time 2.39
Masks aggregated with time 17.09
Update generated with time 44.94
Update aggregated with time: 5.01
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Model distributed with time: 29.14
Round 15 Loss: 1.8093, Acc: 0.4262
Client 0 trained with time 9.84
Mask generated for client 0 with time 1.95
Client 1 trained with time 10.13
Mask generated for client 1 with time 1.93
Client 2 trained with time 10.29
Mask generated for client 2 with time 2.03
Client 3 trained with time 11.53
Mask generated for client 3 with time 1.21
Client 4 trained with time 11.28
Mask generated for client 4 with time 1.92
Client 5 trained with time 11.19
Mask generated for client 5 with time 2.46
Client 6 trained with time 11.34
Mask generated for client 6 with time 1.82
Client 7 trained with time 11.89
Mask generated for client 7 with time 2.18
Client 8 trained with time 11.01
Mask generated for client 8 with time 1.89
Client 9 trained with time 11.11
Mask generated for client 9 with time 2.56
Masks aggregated with time 16.25
Update generated with time 53.06
Update aggregated with time: 4.42
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Model distributed with time: 28.45
Round 16 Loss: 1.7003, Acc: 0.4596
Client 0 trained with time 9.74
Mask generated for client 0 with time 1.86
Client 1 trained with time 10.01
Mask generated for client 1 with time 1.90
Client 2 trained with time 9.99
Mask generated for client 2 with time 1.81
Client 3 trained with time 9.83
Mask generated for client 3 with time 2.20
Client 4 trained with time 9.64
Mask generated for client 4 with time 2.47
Client 5 trained with time 9.95
Mask generated for client 5 with time 2.88
Client 6 trained with time 11.94
Mask generated for client 6 with time 2.22
Client 7 trained with time 11.00
Mask generated for client 7 with time 2.37
Client 8 trained with time 11.37
Mask generated for client 8 with time 2.32
Client 9 trained with time 11.45
Mask generated for client 9 with time 1.68
Masks aggregated with time 16.88
Update generated with time 50.98
Update aggregated with time: 4.92
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Model distributed with time: 30.40
Round 17 Loss: 1.4667, Acc: 0.5264
Client 0 trained with time 9.58
Mask generated for client 0 with time 1.93
Client 1 trained with time 9.45
Mask generated for client 1 with time 1.66
Client 2 trained with time 9.73
Mask generated for client 2 with time 1.36
Client 3 trained with time 9.54
Mask generated for client 3 with time 1.62
Client 4 trained with time 9.37
Mask generated for client 4 with time 1.52
Client 5 trained with time 10.05
Mask generated for client 5 with time 1.86
Client 6 trained with time 9.67
Mask generated for client 6 with time 2.20
Client 7 trained with time 10.26
Mask generated for client 7 with time 1.29
Client 8 trained with time 10.72
Mask generated for client 8 with time 1.56
Client 9 trained with time 10.59
Mask generated for client 9 with time 1.60
Masks aggregated with time 15.66
Update generated with time 53.62
Update aggregated with time: 4.67
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Model distributed with time: 29.73
Round 18 Loss: 1.6983, Acc: 0.4346
Client 0 trained with time 11.06
Mask generated for client 0 with time 1.93
Client 1 trained with time 11.39
Mask generated for client 1 with time 1.82
Client 2 trained with time 10.03
Mask generated for client 2 with time 1.81
Client 3 trained with time 9.35
Mask generated for client 3 with time 1.95
Client 4 trained with time 9.78
Mask generated for client 4 with time 1.90
Client 5 trained with time 9.82
Mask generated for client 5 with time 2.18
Client 6 trained with time 9.70
Mask generated for client 6 with time 2.17
Client 7 trained with time 9.75
Mask generated for client 7 with time 2.25
Client 8 trained with time 10.25
Mask generated for client 8 with time 2.32
Client 9 trained with time 9.72
Mask generated for client 9 with time 2.65
Masks aggregated with time 15.01
Update generated with time 43.90
Update aggregated with time: 4.11
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Model distributed with time: 25.81
Round 19 Loss: 1.8087, Acc: 0.4380
Client 0 trained with time 11.35
Mask generated for client 0 with time 2.26
Client 1 trained with time 11.76
Mask generated for client 1 with time 2.33
Client 2 trained with time 11.25
Mask generated for client 2 with time 2.18
Client 3 trained with time 10.67
Mask generated for client 3 with time 2.23
Client 4 trained with time 9.92
Mask generated for client 4 with time 1.62
Client 5 trained with time 9.07
Mask generated for client 5 with time 1.69
Client 6 trained with time 9.24
Mask generated for client 6 with time 1.35
Client 7 trained with time 9.10
Mask generated for client 7 with time 1.74
Client 8 trained with time 9.68
Mask generated for client 8 with time 1.53
Client 9 trained with time 9.43
Mask generated for client 9 with time 1.54
Masks aggregated with time 10.62
Update generated with time 40.35
Update aggregated with time: 4.29
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Model distributed with time: 26.89
Round 20 Loss: 1.8805, Acc: 0.4061
{'data_name': 'imagenette', 'model_name': 'resnet18', 'algorithm': 'fedhypro', 'n_client': 10, 'n_round': 20, 'n_epoch': 3, 'device': 'cuda', 'lr': 0.01, 'he_rate': 0.1, 'repeat': 5, 'split': 'iid', 'save_path': './res', 'dp': {'eps': 0.5, 'delta': 1e-05, 'clip_thr': 10}, 'dynamic': {'enabled': True, 'punish': 0.975}, 'db': 'db/data.db'}
Running experiment resnet18-0.1*0.975-fedhypro_max-iid-2
Data fetched
Model fetched
path: ./temp/imagenette-c10-iid.npy
Loading partition from ./temp/imagenette-c10-iid.npy
Data splitted
start fedhypro
Start Training
Client 0 trained with time 10.64
Mask generated for client 0 with time 1.71
Client 1 trained with time 9.81
Mask generated for client 1 with time 1.36
Client 2 trained with time 10.41
Mask generated for client 2 with time 1.58
Client 3 trained with time 9.87
Mask generated for client 3 with time 1.51
Client 4 trained with time 10.44
Mask generated for client 4 with time 1.24
Client 5 trained with time 10.34
Mask generated for client 5 with time 1.59
Client 6 trained with time 9.03
Mask generated for client 6 with time 1.42
Client 7 trained with time 8.22
Mask generated for client 7 with time 1.13
Client 8 trained with time 8.30
Mask generated for client 8 with time 1.65
Client 9 trained with time 8.78
Mask generated for client 9 with time 1.55
Masks aggregated with time 12.93
Update generated with time 55.82
Update aggregated with time: 5.66
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Model distributed with time: 38.37
Round 1 Loss: 55498565224599456.0000, Acc: 0.1055
Client 0 trained with time 11.37
Mask generated for client 0 with time 2.39
Client 1 trained with time 10.52
Mask generated for client 1 with time 1.73
Client 2 trained with time 11.21
Mask generated for client 2 with time 1.64
Client 3 trained with time 11.21
Mask generated for client 3 with time 1.69
Client 4 trained with time 10.42
Mask generated for client 4 with time 1.53
Client 5 trained with time 10.47
Mask generated for client 5 with time 1.53
Client 6 trained with time 9.85
Mask generated for client 6 with time 1.15
Client 7 trained with time 9.55
Mask generated for client 7 with time 1.79
Client 8 trained with time 9.74
Mask generated for client 8 with time 1.66
Client 9 trained with time 10.12
Mask generated for client 9 with time 1.92
Masks aggregated with time 13.46
Update generated with time 57.81
Update aggregated with time: 6.68
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Model distributed with time: 30.72
Round 2 Loss: 44.6951, Acc: 0.0994
Client 0 trained with time 11.84
Mask generated for client 0 with time 1.75
Client 1 trained with time 11.76
Mask generated for client 1 with time 2.62
Client 2 trained with time 11.05
Mask generated for client 2 with time 2.26
Client 3 trained with time 11.73
Mask generated for client 3 with time 1.76
Client 4 trained with time 11.20
Mask generated for client 4 with time 2.55
Client 5 trained with time 11.13
Mask generated for client 5 with time 1.91
Client 6 trained with time 9.14
Mask generated for client 6 with time 1.60
Client 7 trained with time 9.56
Mask generated for client 7 with time 1.48
Client 8 trained with time 9.25
Mask generated for client 8 with time 1.27
Client 9 trained with time 9.95
Mask generated for client 9 with time 1.64
Masks aggregated with time 13.32
Update generated with time 47.04
Update aggregated with time: 5.29
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Model distributed with time: 27.80
Round 3 Loss: 4.0632, Acc: 0.1149
Client 0 trained with time 12.33
Mask generated for client 0 with time 2.09
Client 1 trained with time 12.52
Mask generated for client 1 with time 2.49
Client 2 trained with time 12.58
Mask generated for client 2 with time 2.04
Client 3 trained with time 12.21
Mask generated for client 3 with time 2.09
Client 4 trained with time 11.73
Mask generated for client 4 with time 2.36
Client 5 trained with time 11.37
Mask generated for client 5 with time 2.19
Client 6 trained with time 10.94
Mask generated for client 6 with time 2.47
Client 7 trained with time 11.06
Mask generated for client 7 with time 1.72
Client 8 trained with time 11.47
Mask generated for client 8 with time 2.26
Client 9 trained with time 11.28
Mask generated for client 9 with time 1.66
Masks aggregated with time 14.80
Update generated with time 50.17
Update aggregated with time: 5.05
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Model distributed with time: 27.07
Round 4 Loss: 2.9811, Acc: 0.1699
Client 0 trained with time 13.08
Mask generated for client 0 with time 3.02
Client 1 trained with time 11.98
Mask generated for client 1 with time 2.85
Client 2 trained with time 12.52
Mask generated for client 2 with time 2.88
Client 3 trained with time 12.49
Mask generated for client 3 with time 3.05
Client 4 trained with time 12.51
Mask generated for client 4 with time 3.35
Client 5 trained with time 12.83
Mask generated for client 5 with time 2.83
Client 6 trained with time 11.88
Mask generated for client 6 with time 2.86
Client 7 trained with time 12.00
Mask generated for client 7 with time 2.55
Client 8 trained with time 11.68
Mask generated for client 8 with time 2.77
Client 9 trained with time 11.52
Mask generated for client 9 with time 2.74
Masks aggregated with time 17.98
Update generated with time 53.67
Update aggregated with time: 4.34
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Model distributed with time: 23.71
Round 5 Loss: 3.1107, Acc: 0.1946
Client 0 trained with time 12.94
Mask generated for client 0 with time 2.21
Client 1 trained with time 12.90
Mask generated for client 1 with time 2.88
Client 2 trained with time 13.42
Mask generated for client 2 with time 3.45
Client 3 trained with time 13.58
Mask generated for client 3 with time 3.20
Client 4 trained with time 13.62
Mask generated for client 4 with time 3.23
Client 5 trained with time 13.39
Mask generated for client 5 with time 2.38
Client 6 trained with time 13.02
Mask generated for client 6 with time 2.78
Client 7 trained with time 14.30
Mask generated for client 7 with time 3.06
Client 8 trained with time 12.87
Mask generated for client 8 with time 3.40
Client 9 trained with time 13.09
Mask generated for client 9 with time 2.98
Masks aggregated with time 21.56
Update generated with time 68.57
Update aggregated with time: 5.68
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Model distributed with time: 31.72
Round 6 Loss: 2.4503, Acc: 0.2476
Client 0 trained with time 12.71
Mask generated for client 0 with time 2.95
Client 1 trained with time 13.15
Mask generated for client 1 with time 3.09
Client 2 trained with time 13.25
Mask generated for client 2 with time 2.97
Client 3 trained with time 13.95
Mask generated for client 3 with time 2.56
Client 4 trained with time 13.10
Mask generated for client 4 with time 3.18
Client 5 trained with time 13.92
Mask generated for client 5 with time 3.44
Client 6 trained with time 13.23
Mask generated for client 6 with time 3.41
Client 7 trained with time 12.93
Mask generated for client 7 with time 2.69
Client 8 trained with time 13.43
Mask generated for client 8 with time 2.91
Client 9 trained with time 13.20
Mask generated for client 9 with time 3.03
Masks aggregated with time 22.64
Update generated with time 70.24
Update aggregated with time: 6.07
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Model distributed with time: 34.83
Round 7 Loss: 2.2145, Acc: 0.3011
Client 0 trained with time 11.48
Mask generated for client 0 with time 2.19
Client 1 trained with time 11.64
Mask generated for client 1 with time 2.13
Client 2 trained with time 11.85
Mask generated for client 2 with time 3.20
Client 3 trained with time 12.25
Mask generated for client 3 with time 3.18
Client 4 trained with time 12.29
Mask generated for client 4 with time 2.94
Client 5 trained with time 12.56
Mask generated for client 5 with time 3.16
Client 6 trained with time 12.79
Mask generated for client 6 with time 3.60
Client 7 trained with time 13.32
Mask generated for client 7 with time 2.97
Client 8 trained with time 12.56
Mask generated for client 8 with time 3.09
Client 9 trained with time 13.27
Mask generated for client 9 with time 3.15
Masks aggregated with time 21.53
Update generated with time 60.46
Update aggregated with time: 6.01
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Model distributed with time: 30.34
Round 8 Loss: 2.2626, Acc: 0.2920
Client 0 trained with time 12.43
Mask generated for client 0 with time 3.08
Client 1 trained with time 12.86
Mask generated for client 1 with time 2.12
Client 2 trained with time 12.03
Mask generated for client 2 with time 1.74
Client 3 trained with time 12.09
Mask generated for client 3 with time 2.42
Client 4 trained with time 10.98
Mask generated for client 4 with time 2.04
Client 5 trained with time 11.64
Mask generated for client 5 with time 2.67
Client 6 trained with time 10.93
Mask generated for client 6 with time 2.22
Client 7 trained with time 11.10
Mask generated for client 7 with time 2.06
Client 8 trained with time 10.99
Mask generated for client 8 with time 1.88
Client 9 trained with time 11.31
Mask generated for client 9 with time 2.36
Masks aggregated with time 15.31
Update generated with time 57.77
Update aggregated with time: 6.36
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Model distributed with time: 35.04
Round 9 Loss: 2.2927, Acc: 0.3213
Client 0 trained with time 10.12
Mask generated for client 0 with time 2.11
Client 1 trained with time 10.65
Mask generated for client 1 with time 2.41
Client 2 trained with time 10.43
Mask generated for client 2 with time 1.40
Client 3 trained with time 10.58
Mask generated for client 3 with time 1.48
Client 4 trained with time 10.21
Mask generated for client 4 with time 2.03
Client 5 trained with time 11.63
Mask generated for client 5 with time 2.44
Client 6 trained with time 12.02
Mask generated for client 6 with time 2.40
Client 7 trained with time 11.79
Mask generated for client 7 with time 1.51
Client 8 trained with time 11.15
Mask generated for client 8 with time 2.42
Client 9 trained with time 11.62
Mask generated for client 9 with time 2.58
Masks aggregated with time 19.33
Update generated with time 55.14
Update aggregated with time: 4.80
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Model distributed with time: 29.89
Round 10 Loss: 1.9334, Acc: 0.3676
Client 0 trained with time 12.19
Mask generated for client 0 with time 2.36
Client 1 trained with time 12.07
Mask generated for client 1 with time 2.24
Client 2 trained with time 12.72
Mask generated for client 2 with time 2.25
Client 3 trained with time 11.92
Mask generated for client 3 with time 2.60
Client 4 trained with time 12.12
Mask generated for client 4 with time 2.79
Client 5 trained with time 12.63
Mask generated for client 5 with time 2.05
Client 6 trained with time 11.41
Mask generated for client 6 with time 2.52
Client 7 trained with time 10.99
Mask generated for client 7 with time 2.18
Client 8 trained with time 10.33
Mask generated for client 8 with time 2.27
Client 9 trained with time 11.18
Mask generated for client 9 with time 2.80
Masks aggregated with time 15.89
Update generated with time 51.45
Update aggregated with time: 4.70
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Model distributed with time: 26.79
Round 11 Loss: 2.1801, Acc: 0.3276
Client 0 trained with time 11.82
Mask generated for client 0 with time 3.00
Client 1 trained with time 12.66
Mask generated for client 1 with time 2.94
Client 2 trained with time 12.38
Mask generated for client 2 with time 1.81
Client 3 trained with time 12.24
Mask generated for client 3 with time 2.72
Client 4 trained with time 12.07
Mask generated for client 4 with time 3.35
Client 5 trained with time 12.44
Mask generated for client 5 with time 2.09
Client 6 trained with time 12.21
Mask generated for client 6 with time 2.13
Client 7 trained with time 13.08
Mask generated for client 7 with time 3.22
Client 8 trained with time 12.45
Mask generated for client 8 with time 3.01
Client 9 trained with time 12.53
Mask generated for client 9 with time 3.33
Masks aggregated with time 19.07
Update generated with time 54.58
Update aggregated with time: 5.12
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Model distributed with time: 25.71
Round 12 Loss: 1.8842, Acc: 0.3725
Client 0 trained with time 13.60
Mask generated for client 0 with time 2.62
Client 1 trained with time 13.20
Mask generated for client 1 with time 3.45
Client 2 trained with time 12.76
Mask generated for client 2 with time 2.77
Client 3 trained with time 13.85
Mask generated for client 3 with time 2.72
Client 4 trained with time 13.49
Mask generated for client 4 with time 2.66
Client 5 trained with time 12.74
Mask generated for client 5 with time 3.22
Client 6 trained with time 13.07
Mask generated for client 6 with time 2.99
Client 7 trained with time 13.25
Mask generated for client 7 with time 2.84
Client 8 trained with time 12.75
Mask generated for client 8 with time 2.47
Client 9 trained with time 13.17
Mask generated for client 9 with time 2.69
Masks aggregated with time 19.78
Update generated with time 59.76
Update aggregated with time: 5.96
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Model distributed with time: 30.33
Round 13 Loss: 1.7808, Acc: 0.4369
Client 0 trained with time 12.61
Mask generated for client 0 with time 2.78
Client 1 trained with time 12.62
Mask generated for client 1 with time 2.11
Client 2 trained with time 12.74
Mask generated for client 2 with time 2.25
Client 3 trained with time 12.23
Mask generated for client 3 with time 2.82
Client 4 trained with time 13.37
Mask generated for client 4 with time 3.06
Client 5 trained with time 13.91
Mask generated for client 5 with time 3.29
Client 6 trained with time 12.90
Mask generated for client 6 with time 3.37
Client 7 trained with time 13.20
Mask generated for client 7 with time 2.97
Client 8 trained with time 13.28
Mask generated for client 8 with time 2.94
Client 9 trained with time 13.62
Mask generated for client 9 with time 3.16
Masks aggregated with time 18.73
Update generated with time 68.70
Update aggregated with time: 5.79
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Model distributed with time: 32.47
Round 14 Loss: 1.7324, Acc: 0.4313
Client 0 trained with time 12.21
Mask generated for client 0 with time 2.07
Client 1 trained with time 12.13
Mask generated for client 1 with time 3.01
Client 2 trained with time 12.82
Mask generated for client 2 with time 2.82
Client 3 trained with time 12.46
Mask generated for client 3 with time 2.51
Client 4 trained with time 12.22
Mask generated for client 4 with time 2.39
Client 5 trained with time 12.73
Mask generated for client 5 with time 2.58
Client 6 trained with time 13.18
Mask generated for client 6 with time 2.52
Client 7 trained with time 13.08
Mask generated for client 7 with time 2.88
Client 8 trained with time 14.03
Mask generated for client 8 with time 2.20
Client 9 trained with time 13.25
Mask generated for client 9 with time 2.43
Masks aggregated with time 21.62
Update generated with time 63.90
Update aggregated with time: 6.03
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Model distributed with time: 35.63
Round 15 Loss: 2.0155, Acc: 0.3730
Client 0 trained with time 11.16
Mask generated for client 0 with time 2.26
Client 1 trained with time 12.26
Mask generated for client 1 with time 2.30
Client 2 trained with time 11.50
Mask generated for client 2 with time 2.58
Client 3 trained with time 11.64
Mask generated for client 3 with time 2.55
Client 4 trained with time 12.29
Mask generated for client 4 with time 2.49
Client 5 trained with time 11.50
Mask generated for client 5 with time 3.08
Client 6 trained with time 12.15
Mask generated for client 6 with time 2.52
Client 7 trained with time 11.27
Mask generated for client 7 with time 2.31
Client 8 trained with time 11.86
Mask generated for client 8 with time 2.51
Client 9 trained with time 11.84
Mask generated for client 9 with time 3.14
Masks aggregated with time 21.57
Update generated with time 65.36
Update aggregated with time: 5.92
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Model distributed with time: 34.99
Round 16 Loss: 1.8228, Acc: 0.4308
Client 0 trained with time 11.82
Mask generated for client 0 with time 2.64
Client 1 trained with time 11.99
Mask generated for client 1 with time 2.56
Client 2 trained with time 12.69
Mask generated for client 2 with time 2.29
Client 3 trained with time 12.61
Mask generated for client 3 with time 2.40
Client 4 trained with time 11.21
Mask generated for client 4 with time 3.02
Client 5 trained with time 12.01
Mask generated for client 5 with time 3.17
Client 6 trained with time 11.53
Mask generated for client 6 with time 2.50
Client 7 trained with time 11.91
Mask generated for client 7 with time 2.75
Client 8 trained with time 12.09
Mask generated for client 8 with time 2.72
Client 9 trained with time 12.05
Mask generated for client 9 with time 2.08
Masks aggregated with time 20.01
Update generated with time 59.35
Update aggregated with time: 5.77
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Model distributed with time: 32.48
Round 17 Loss: 1.6853, Acc: 0.4403
Client 0 trained with time 11.73
Mask generated for client 0 with time 1.59
Client 1 trained with time 11.85
Mask generated for client 1 with time 2.32
Client 2 trained with time 11.87
Mask generated for client 2 with time 2.01
Client 3 trained with time 12.15
Mask generated for client 3 with time 2.95
Client 4 trained with time 11.86
Mask generated for client 4 with time 2.42
Client 5 trained with time 12.58
Mask generated for client 5 with time 2.81
Client 6 trained with time 11.75
Mask generated for client 6 with time 2.88
Client 7 trained with time 11.96
Mask generated for client 7 with time 2.99
Client 8 trained with time 11.36
Mask generated for client 8 with time 1.91
Client 9 trained with time 10.91
Mask generated for client 9 with time 2.44
Masks aggregated with time 18.35
Update generated with time 49.72
Update aggregated with time: 4.05
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Model distributed with time: 29.61
Round 18 Loss: 1.5487, Acc: 0.4999
Client 0 trained with time 10.89
Mask generated for client 0 with time 2.09
Client 1 trained with time 10.21
Mask generated for client 1 with time 2.12
Client 2 trained with time 11.01
Mask generated for client 2 with time 1.79
Client 3 trained with time 11.51
Mask generated for client 3 with time 1.96
Client 4 trained with time 11.93
Mask generated for client 4 with time 1.90
Client 5 trained with time 11.47
Mask generated for client 5 with time 2.15
Client 6 trained with time 11.14
Mask generated for client 6 with time 2.24
Client 7 trained with time 12.15
Mask generated for client 7 with time 1.85
Client 8 trained with time 11.54
Mask generated for client 8 with time 2.46
Client 9 trained with time 11.69
Mask generated for client 9 with time 2.03
Masks aggregated with time 18.31
Update generated with time 56.80
Update aggregated with time: 5.05
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Model distributed with time: 31.24
Round 19 Loss: 1.6854, Acc: 0.4423
Client 0 trained with time 10.30
Mask generated for client 0 with time 2.33
Client 1 trained with time 11.29
Mask generated for client 1 with time 2.98
Client 2 trained with time 10.66
Mask generated for client 2 with time 2.25
Client 3 trained with time 10.33
Mask generated for client 3 with time 2.79
Client 4 trained with time 11.15
Mask generated for client 4 with time 2.63
Client 5 trained with time 12.10
Mask generated for client 5 with time 2.91
Client 6 trained with time 11.30
Mask generated for client 6 with time 3.22
Client 7 trained with time 12.25
Mask generated for client 7 with time 2.75
Client 8 trained with time 12.01
Mask generated for client 8 with time 2.94
Client 9 trained with time 11.88
Mask generated for client 9 with time 3.15
Masks aggregated with time 20.08
Update generated with time 58.36
Update aggregated with time: 4.24
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Model distributed with time: 30.61
Round 20 Loss: 1.6106, Acc: 0.4698
{'data_name': 'imagenette', 'model_name': 'resnet18', 'algorithm': 'fedhypro', 'n_client': 10, 'n_round': 20, 'n_epoch': 3, 'device': 'cuda', 'lr': 0.01, 'he_rate': 0.1, 'repeat': 5, 'split': 'iid', 'save_path': './res', 'dp': {'eps': 0.5, 'delta': 1e-05, 'clip_thr': 10}, 'dynamic': {'enabled': True, 'punish': 0.975}, 'db': 'db/data.db'}
Running experiment resnet18-0.1*0.975-fedhypro_max-iid-3
Data fetched
Model fetched
path: ./temp/imagenette-c10-iid.npy
Loading partition from ./temp/imagenette-c10-iid.npy
Data splitted
start fedhypro
Start Training
Client 0 trained with time 10.66
Mask generated for client 0 with time 2.15
Client 1 trained with time 10.04
Mask generated for client 1 with time 2.23
Client 2 trained with time 10.33
Mask generated for client 2 with time 1.73
Client 3 trained with time 10.65
Mask generated for client 3 with time 2.38
Client 4 trained with time 10.82
Mask generated for client 4 with time 1.62
Client 5 trained with time 9.75
Mask generated for client 5 with time 2.19
Client 6 trained with time 10.48
Mask generated for client 6 with time 2.03
Client 7 trained with time 10.68
Mask generated for client 7 with time 2.21
Client 8 trained with time 10.57
Mask generated for client 8 with time 2.41
Client 9 trained with time 10.91
Mask generated for client 9 with time 2.79
Masks aggregated with time 18.73
Update generated with time 68.57
Update aggregated with time: 7.22
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Model distributed with time: 41.86
Round 1 Loss: 19296245415605656.0000, Acc: 0.1238
Client 0 trained with time 11.76
Mask generated for client 0 with time 2.84
Client 1 trained with time 11.74
Mask generated for client 1 with time 3.19
Client 2 trained with time 11.72
Mask generated for client 2 with time 2.72
Client 3 trained with time 11.49
Mask generated for client 3 with time 2.64
Client 4 trained with time 12.54
Mask generated for client 4 with time 2.81
Client 5 trained with time 12.51
Mask generated for client 5 with time 2.78
Client 6 trained with time 11.07
Mask generated for client 6 with time 2.92
Client 7 trained with time 11.48
Mask generated for client 7 with time 3.25
Client 8 trained with time 12.65
Mask generated for client 8 with time 3.27
Client 9 trained with time 12.39
Mask generated for client 9 with time 2.81
Masks aggregated with time 20.60
Update generated with time 76.45
Update aggregated with time: 7.76
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Model distributed with time: 35.90
Round 2 Loss: 46.6812, Acc: 0.1068
Client 0 trained with time 10.96
Mask generated for client 0 with time 2.16
Client 1 trained with time 12.64
Mask generated for client 1 with time 1.91
Client 2 trained with time 11.45
Mask generated for client 2 with time 2.33
Client 3 trained with time 12.34
Mask generated for client 3 with time 2.80
Client 4 trained with time 12.52
Mask generated for client 4 with time 2.25
Client 5 trained with time 11.63
Mask generated for client 5 with time 2.85
Client 6 trained with time 11.59
Mask generated for client 6 with time 2.07
Client 7 trained with time 12.56
Mask generated for client 7 with time 2.40
Client 8 trained with time 12.24
Mask generated for client 8 with time 2.70
Client 9 trained with time 12.39
Mask generated for client 9 with time 2.73
Masks aggregated with time 18.21
Update generated with time 70.18
Update aggregated with time: 7.59
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Model distributed with time: 34.15
Round 3 Loss: 5.2100, Acc: 0.1070
Client 0 trained with time 10.88
Mask generated for client 0 with time 2.04
Client 1 trained with time 10.78
Mask generated for client 1 with time 2.52
Client 2 trained with time 10.80
Mask generated for client 2 with time 2.73
Client 3 trained with time 10.55
Mask generated for client 3 with time 2.00
Client 4 trained with time 10.29
Mask generated for client 4 with time 2.77
Client 5 trained with time 11.60
Mask generated for client 5 with time 2.20
Client 6 trained with time 11.76
Mask generated for client 6 with time 2.48
Client 7 trained with time 12.11
Mask generated for client 7 with time 2.72
Client 8 trained with time 12.33
Mask generated for client 8 with time 2.22
Client 9 trained with time 12.07
Mask generated for client 9 with time 2.33
Masks aggregated with time 19.14
Update generated with time 66.57
Update aggregated with time: 6.63
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Model distributed with time: 34.33
Round 4 Loss: 3.2889, Acc: 0.1121
Client 0 trained with time 11.49
Mask generated for client 0 with time 1.25
Client 1 trained with time 11.55
Mask generated for client 1 with time 1.93
Client 2 trained with time 10.68
Mask generated for client 2 with time 1.96
Client 3 trained with time 10.50
Mask generated for client 3 with time 2.09
Client 4 trained with time 11.30
Mask generated for client 4 with time 2.18
Client 5 trained with time 11.58
Mask generated for client 5 with time 2.12
Client 6 trained with time 10.91
Mask generated for client 6 with time 2.42
Client 7 trained with time 10.88
Mask generated for client 7 with time 2.53
Client 8 trained with time 12.52
Mask generated for client 8 with time 2.56
Client 9 trained with time 12.45
Mask generated for client 9 with time 2.64
Masks aggregated with time 20.43
Update generated with time 72.99
Update aggregated with time: 7.26
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Model distributed with time: 35.02
Round 5 Loss: 4.2404, Acc: 0.1118
Client 0 trained with time 9.67
Mask generated for client 0 with time 1.69
Client 1 trained with time 9.77
Mask generated for client 1 with time 1.77
Client 2 trained with time 10.35
Mask generated for client 2 with time 1.82
Client 3 trained with time 9.40
Mask generated for client 3 with time 1.95
Client 4 trained with time 9.90
Mask generated for client 4 with time 1.63
Client 5 trained with time 9.53
Mask generated for client 5 with time 1.84
Client 6 trained with time 9.69
Mask generated for client 6 with time 2.23
Client 7 trained with time 11.36
Mask generated for client 7 with time 2.03
Client 8 trained with time 12.10
Mask generated for client 8 with time 2.87
Client 9 trained with time 12.25
Mask generated for client 9 with time 1.82
Masks aggregated with time 18.07
Update generated with time 68.24
Update aggregated with time: 7.17
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Model distributed with time: 38.36
Round 6 Loss: 2.7527, Acc: 0.2418
Client 0 trained with time 8.63
Mask generated for client 0 with time 1.45
Client 1 trained with time 8.31
Mask generated for client 1 with time 1.52
Client 2 trained with time 9.06
Mask generated for client 2 with time 1.64
Client 3 trained with time 8.87
Mask generated for client 3 with time 1.56
Client 4 trained with time 9.04
Mask generated for client 4 with time 1.78
Client 5 trained with time 9.45
Mask generated for client 5 with time 2.54
Client 6 trained with time 9.90
Mask generated for client 6 with time 1.76
Client 7 trained with time 9.81
Mask generated for client 7 with time 2.19
Client 8 trained with time 9.88
Mask generated for client 8 with time 2.31
Client 9 trained with time 10.98
Mask generated for client 9 with time 2.19
Masks aggregated with time 14.51
Update generated with time 49.00
Update aggregated with time: 5.42
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Model distributed with time: 27.69
Round 7 Loss: 1.9199, Acc: 0.3610
Client 0 trained with time 9.83
Mask generated for client 0 with time 1.81
Client 1 trained with time 8.86
Mask generated for client 1 with time 1.71
Client 2 trained with time 8.62
Mask generated for client 2 with time 1.50
Client 3 trained with time 9.35
Mask generated for client 3 with time 1.64
Client 4 trained with time 10.35
Mask generated for client 4 with time 1.62
Client 5 trained with time 9.49
Mask generated for client 5 with time 1.51
Client 6 trained with time 9.26
Mask generated for client 6 with time 1.40
Client 7 trained with time 9.58
Mask generated for client 7 with time 2.12
Client 8 trained with time 10.37
Mask generated for client 8 with time 2.17
Client 9 trained with time 9.55
Mask generated for client 9 with time 1.48
Masks aggregated with time 11.46
Update generated with time 47.07
Update aggregated with time: 4.48
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Model distributed with time: 22.59
Round 8 Loss: 2.1785, Acc: 0.3745
Client 0 trained with time 10.43
Mask generated for client 0 with time 2.08
Client 1 trained with time 9.75
Mask generated for client 1 with time 1.71
Client 2 trained with time 10.13
Mask generated for client 2 with time 1.25
Client 3 trained with time 10.66
Mask generated for client 3 with time 1.65
Client 4 trained with time 9.90
Mask generated for client 4 with time 1.81
Client 5 trained with time 10.68
Mask generated for client 5 with time 1.79
Client 6 trained with time 10.65
Mask generated for client 6 with time 2.57
Client 7 trained with time 11.69
Mask generated for client 7 with time 2.07
Client 8 trained with time 11.38
Mask generated for client 8 with time 2.44
Client 9 trained with time 12.21
Mask generated for client 9 with time 2.25
Masks aggregated with time 16.83
Update generated with time 45.01
Update aggregated with time: 5.28
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Modi he_rate: 0.07962355085707054
Model distributed with time: 23.31
Round 9 Loss: 1.9941, Acc: 0.3389
Client 0 trained with time 12.07
Mask generated for client 0 with time 2.70
Client 1 trained with time 11.98
Mask generated for client 1 with time 2.64
Client 2 trained with time 11.67
Mask generated for client 2 with time 2.50
Client 3 trained with time 12.62
Mask generated for client 3 with time 2.96
Client 4 trained with time 11.39
Mask generated for client 4 with time 2.42
Client 5 trained with time 12.20
Mask generated for client 5 with time 2.00
Client 6 trained with time 11.73
Mask generated for client 6 with time 2.22
Client 7 trained with time 12.47
Mask generated for client 7 with time 2.70
Client 8 trained with time 12.21
Mask generated for client 8 with time 3.05
Client 9 trained with time 12.17
Mask generated for client 9 with time 2.73
Masks aggregated with time 19.11
Update generated with time 64.98
Update aggregated with time: 5.23
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Modi he_rate: 0.07763296208564377
Model distributed with time: 29.39
Round 10 Loss: 1.9097, Acc: 0.3811
Client 0 trained with time 12.93
Mask generated for client 0 with time 2.94
Client 1 trained with time 13.44
Mask generated for client 1 with time 2.42
Client 2 trained with time 13.78
Mask generated for client 2 with time 2.38
Client 3 trained with time 13.01
Mask generated for client 3 with time 2.60
Client 4 trained with time 13.74
Mask generated for client 4 with time 2.91
Client 5 trained with time 13.22
Mask generated for client 5 with time 3.64
Client 6 trained with time 14.12
Mask generated for client 6 with time 3.38
Client 7 trained with time 14.99
Mask generated for client 7 with time 3.03
Client 8 trained with time 14.43
Mask generated for client 8 with time 3.41
Client 9 trained with time 14.38
Mask generated for client 9 with time 3.38
Masks aggregated with time 21.61
Update generated with time 68.37
Update aggregated with time: 6.28
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Modi he_rate: 0.07569213803350268
Model distributed with time: 37.35
Round 11 Loss: 2.1600, Acc: 0.3493
Client 0 trained with time 13.73
Mask generated for client 0 with time 2.04
Client 1 trained with time 13.26
Mask generated for client 1 with time 2.36
Client 2 trained with time 13.17
Mask generated for client 2 with time 2.88
Client 3 trained with time 13.47
Mask generated for client 3 with time 3.13
Client 4 trained with time 13.54
Mask generated for client 4 with time 3.03
Client 5 trained with time 14.13
Mask generated for client 5 with time 2.35
Client 6 trained with time 13.63
Mask generated for client 6 with time 2.45
Client 7 trained with time 14.20
Mask generated for client 7 with time 3.01
Client 8 trained with time 14.61
Mask generated for client 8 with time 2.46
Client 9 trained with time 14.62
Mask generated for client 9 with time 3.11
Masks aggregated with time 22.05
Update generated with time 66.53
Update aggregated with time: 6.55
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Modi he_rate: 0.0737998345826651
Model distributed with time: 37.09
Round 12 Loss: 1.7617, Acc: 0.4189
Client 0 trained with time 13.51
Mask generated for client 0 with time 2.24
Client 1 trained with time 12.72
Mask generated for client 1 with time 2.22
Client 2 trained with time 13.15
Mask generated for client 2 with time 2.56
Client 3 trained with time 13.60
Mask generated for client 3 with time 2.77
Client 4 trained with time 13.63
Mask generated for client 4 with time 2.84
Client 5 trained with time 13.39
Mask generated for client 5 with time 2.25
Client 6 trained with time 14.14
Mask generated for client 6 with time 3.04
Client 7 trained with time 14.34
Mask generated for client 7 with time 2.48
Client 8 trained with time 14.48
Mask generated for client 8 with time 2.99
Client 9 trained with time 14.31
Mask generated for client 9 with time 3.47
Masks aggregated with time 22.77
Update generated with time 69.81
Update aggregated with time: 5.87
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Modi he_rate: 0.07195483871809848
Model distributed with time: 37.45
Round 13 Loss: 1.8275, Acc: 0.3944
Client 0 trained with time 12.64
Mask generated for client 0 with time 2.46
Client 1 trained with time 12.18
Mask generated for client 1 with time 2.88
Client 2 trained with time 12.56
Mask generated for client 2 with time 2.87
Client 3 trained with time 12.39
Mask generated for client 3 with time 2.81
Client 4 trained with time 13.42
Mask generated for client 4 with time 2.95
Client 5 trained with time 13.34
Mask generated for client 5 with time 2.73
Client 6 trained with time 13.80
Mask generated for client 6 with time 2.70
Client 7 trained with time 13.76
Mask generated for client 7 with time 2.66
Client 8 trained with time 14.02
Mask generated for client 8 with time 3.08
Client 9 trained with time 14.90
Mask generated for client 9 with time 2.50
Masks aggregated with time 21.25
Update generated with time 68.33
Update aggregated with time: 5.72
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Modi he_rate: 0.07015596775014601
Model distributed with time: 38.13
Round 14 Loss: 1.9829, Acc: 0.3592
Client 0 trained with time 10.87
Mask generated for client 0 with time 1.69
Client 1 trained with time 11.22
Mask generated for client 1 with time 1.76
Client 2 trained with time 12.37
Mask generated for client 2 with time 2.28
Client 3 trained with time 12.20
Mask generated for client 3 with time 2.50
Client 4 trained with time 11.81
Mask generated for client 4 with time 2.47
Client 5 trained with time 11.85
Mask generated for client 5 with time 2.29
Client 6 trained with time 12.33
Mask generated for client 6 with time 2.33
Client 7 trained with time 12.99
Mask generated for client 7 with time 2.48
Client 8 trained with time 12.67
Mask generated for client 8 with time 1.69
Client 9 trained with time 12.49
Mask generated for client 9 with time 2.65
Masks aggregated with time 20.54
Update generated with time 66.60
Update aggregated with time: 6.75
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Modi he_rate: 0.06840206855639236
Model distributed with time: 39.92
Round 15 Loss: 1.7672, Acc: 0.4059
Client 0 trained with time 10.13
Mask generated for client 0 with time 1.96
Client 1 trained with time 9.40
Mask generated for client 1 with time 1.70
Client 2 trained with time 10.62
Mask generated for client 2 with time 1.80
Client 3 trained with time 10.44
Mask generated for client 3 with time 1.71
Client 4 trained with time 11.68
Mask generated for client 4 with time 2.64
Client 5 trained with time 10.72
Mask generated for client 5 with time 2.00
Client 6 trained with time 11.37
Mask generated for client 6 with time 2.25
Client 7 trained with time 10.96
Mask generated for client 7 with time 2.17
Client 8 trained with time 11.93
Mask generated for client 8 with time 2.08
Client 9 trained with time 12.03
Mask generated for client 9 with time 2.00
Masks aggregated with time 15.93
Update generated with time 54.04
Update aggregated with time: 6.11
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Modi he_rate: 0.06669201684248255
Model distributed with time: 38.81
Round 16 Loss: 1.7617, Acc: 0.4285
Client 0 trained with time 10.47
Mask generated for client 0 with time 1.67
Client 1 trained with time 10.37
Mask generated for client 1 with time 1.50
Client 2 trained with time 9.72
Mask generated for client 2 with time 1.42
Client 3 trained with time 10.81
Mask generated for client 3 with time 1.88
Client 4 trained with time 11.77
Mask generated for client 4 with time 2.14
Client 5 trained with time 12.04
Mask generated for client 5 with time 1.79
Client 6 trained with time 11.68
Mask generated for client 6 with time 2.67
Client 7 trained with time 11.90
Mask generated for client 7 with time 2.07
Client 8 trained with time 11.08
Mask generated for client 8 with time 1.91
Client 9 trained with time 9.92
Mask generated for client 9 with time 2.10
Masks aggregated with time 13.45
Update generated with time 44.68
Update aggregated with time: 3.74
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Modi he_rate: 0.06502471642142048
Model distributed with time: 30.99
Round 17 Loss: 1.5180, Acc: 0.4940
Client 0 trained with time 10.00
Mask generated for client 0 with time 1.82
Client 1 trained with time 11.63
Mask generated for client 1 with time 1.64
Client 2 trained with time 11.28
Mask generated for client 2 with time 1.88
Client 3 trained with time 11.81
Mask generated for client 3 with time 1.73
Client 4 trained with time 12.78
Mask generated for client 4 with time 1.98
Client 5 trained with time 11.66
Mask generated for client 5 with time 2.07
Client 6 trained with time 11.88
Mask generated for client 6 with time 2.56
Client 7 trained with time 12.77
Mask generated for client 7 with time 1.83
Client 8 trained with time 13.15
Mask generated for client 8 with time 1.77
Client 9 trained with time 12.90
Mask generated for client 9 with time 1.65
Masks aggregated with time 10.00
Update generated with time 34.38
Update aggregated with time: 3.20
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Modi he_rate: 0.06339909851088496
Model distributed with time: 21.50
Round 18 Loss: 1.7015, Acc: 0.4469
Client 0 trained with time 13.52
Mask generated for client 0 with time 2.41
Client 1 trained with time 12.81
Mask generated for client 1 with time 2.85
Client 2 trained with time 13.12
Mask generated for client 2 with time 2.74
Client 3 trained with time 12.77
Mask generated for client 3 with time 2.15
Client 4 trained with time 11.69
Mask generated for client 4 with time 1.88
Client 5 trained with time 13.15
Mask generated for client 5 with time 2.67
Client 6 trained with time 12.72
Mask generated for client 6 with time 3.09
Client 7 trained with time 12.86
Mask generated for client 7 with time 2.31
Client 8 trained with time 12.69
Mask generated for client 8 with time 2.99
Client 9 trained with time 13.64
Mask generated for client 9 with time 2.16
Masks aggregated with time 12.39
Update generated with time 36.17
Update aggregated with time: 3.20
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Modi he_rate: 0.06181412104811283
Model distributed with time: 20.89
Round 19 Loss: 1.4835, Acc: 0.4994
Client 0 trained with time 14.03
Mask generated for client 0 with time 2.82
Client 1 trained with time 13.72
Mask generated for client 1 with time 2.55
Client 2 trained with time 14.30
Mask generated for client 2 with time 3.12
Client 3 trained with time 13.67
Mask generated for client 3 with time 2.24
Client 4 trained with time 13.47
Mask generated for client 4 with time 2.70
Client 5 trained with time 14.54
Mask generated for client 5 with time 3.11
Client 6 trained with time 14.60
Mask generated for client 6 with time 3.10
Client 7 trained with time 13.90
Mask generated for client 7 with time 2.32
Client 8 trained with time 13.45
Mask generated for client 8 with time 2.43
Client 9 trained with time 12.20
Mask generated for client 9 with time 1.80
Masks aggregated with time 15.84
Update generated with time 39.48
Update aggregated with time: 2.71
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Modi he_rate: 0.06026876802191001
Model distributed with time: 22.64
Round 20 Loss: 1.5643, Acc: 0.5144
{'data_name': 'imagenette', 'model_name': 'resnet18', 'algorithm': 'fedhypro', 'n_client': 10, 'n_round': 20, 'n_epoch': 3, 'device': 'cuda', 'lr': 0.01, 'he_rate': 0.1, 'repeat': 5, 'split': 'iid', 'save_path': './res', 'dp': {'eps': 0.5, 'delta': 1e-05, 'clip_thr': 10}, 'dynamic': {'enabled': True, 'punish': 0.975}, 'db': 'db/data.db'}
Running experiment resnet18-0.1*0.975-fedhypro_max-iid-4
Data fetched
Model fetched
path: ./temp/imagenette-c10-iid.npy
Loading partition from ./temp/imagenette-c10-iid.npy
Data splitted
start fedhypro
Start Training
Client 0 trained with time 12.43
Mask generated for client 0 with time 2.06
Client 1 trained with time 12.83
Mask generated for client 1 with time 2.61
Client 2 trained with time 12.10
Mask generated for client 2 with time 2.30
Client 3 trained with time 12.08
Mask generated for client 3 with time 1.84
Client 4 trained with time 11.73
Mask generated for client 4 with time 2.05
Client 5 trained with time 12.37
Mask generated for client 5 with time 2.76
Client 6 trained with time 12.25
Mask generated for client 6 with time 2.39
Client 7 trained with time 12.74
Mask generated for client 7 with time 2.38
Client 8 trained with time 12.71
Mask generated for client 8 with time 2.53
Client 9 trained with time 12.53
Mask generated for client 9 with time 2.18
Masks aggregated with time 20.10
Update generated with time 64.25
Update aggregated with time: 5.35
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Modi he_rate: 0.0975
Model distributed with time: 31.27
Round 1 Loss: 52756600572531784.0000, Acc: 0.1068
Client 0 trained with time 13.10
Mask generated for client 0 with time 1.89
Client 1 trained with time 13.52
Mask generated for client 1 with time 2.31
Client 2 trained with time 12.96
Mask generated for client 2 with time 2.31
Client 3 trained with time 12.16
Mask generated for client 3 with time 1.94
Client 4 trained with time 12.37
Mask generated for client 4 with time 1.71
Client 5 trained with time 13.60
Mask generated for client 5 with time 2.16
Client 6 trained with time 12.83
Mask generated for client 6 with time 2.28
Client 7 trained with time 13.76
Mask generated for client 7 with time 2.14
Client 8 trained with time 13.47
Mask generated for client 8 with time 2.23
Client 9 trained with time 13.52
Mask generated for client 9 with time 2.08
Masks aggregated with time 20.67
Update generated with time 68.48
Update aggregated with time: 6.42
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Modi he_rate: 0.0950625
Model distributed with time: 30.49
Round 2 Loss: 42.7540, Acc: 0.1004
Client 0 trained with time 12.41
Mask generated for client 0 with time 2.03
Client 1 trained with time 12.99
Mask generated for client 1 with time 2.22
Client 2 trained with time 11.95
Mask generated for client 2 with time 2.59
Client 3 trained with time 12.68
Mask generated for client 3 with time 2.46
Client 4 trained with time 12.15
Mask generated for client 4 with time 1.91
Client 5 trained with time 12.28
Mask generated for client 5 with time 2.18
Client 6 trained with time 13.17
Mask generated for client 6 with time 2.36
Client 7 trained with time 13.24
Mask generated for client 7 with time 2.54
Client 8 trained with time 12.57
Mask generated for client 8 with time 2.43
Client 9 trained with time 13.03
Mask generated for client 9 with time 2.52
Masks aggregated with time 19.16
Update generated with time 68.93
Update aggregated with time: 7.05
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Modi he_rate: 0.0926859375
Model distributed with time: 33.54
Round 3 Loss: 4.8497, Acc: 0.1167
Client 0 trained with time 11.63
Mask generated for client 0 with time 2.13
Client 1 trained with time 11.99
Mask generated for client 1 with time 2.76
Client 2 trained with time 11.82
Mask generated for client 2 with time 2.56
Client 3 trained with time 12.36
Mask generated for client 3 with time 2.58
Client 4 trained with time 11.29
Mask generated for client 4 with time 2.27
Client 5 trained with time 11.92
Mask generated for client 5 with time 1.99
Client 6 trained with time 13.32
Mask generated for client 6 with time 2.02
Client 7 trained with time 12.90
Mask generated for client 7 with time 1.98
Client 8 trained with time 12.20
Mask generated for client 8 with time 2.21
Client 9 trained with time 13.22
Mask generated for client 9 with time 2.29
Masks aggregated with time 19.16
Update generated with time 68.16
Update aggregated with time: 6.57
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Modi he_rate: 0.0903687890625
Model distributed with time: 34.74
Round 4 Loss: 2.5620, Acc: 0.2364
Client 0 trained with time 11.89
Mask generated for client 0 with time 2.34
Client 1 trained with time 12.41
Mask generated for client 1 with time 2.00
Client 2 trained with time 12.57
Mask generated for client 2 with time 2.08
Client 3 trained with time 12.40
Mask generated for client 3 with time 2.14
Client 4 trained with time 12.05
Mask generated for client 4 with time 1.60
Client 5 trained with time 12.55
Mask generated for client 5 with time 1.96
Client 6 trained with time 12.75
Mask generated for client 6 with time 2.12
Client 7 trained with time 13.02
Mask generated for client 7 with time 2.04
Client 8 trained with time 13.34
Mask generated for client 8 with time 1.88
Client 9 trained with time 12.82
Mask generated for client 9 with time 2.40
Masks aggregated with time 19.11
Update generated with time 63.37
Update aggregated with time: 5.97
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Modi he_rate: 0.0881095693359375
Model distributed with time: 34.21
Round 5 Loss: 2.5863, Acc: 0.2380
Client 0 trained with time 12.23
Mask generated for client 0 with time 2.39
Client 1 trained with time 12.59
Mask generated for client 1 with time 2.14
Client 2 trained with time 12.54
Mask generated for client 2 with time 2.21
Client 3 trained with time 12.07
Mask generated for client 3 with time 2.92
Client 4 trained with time 12.30
Mask generated for client 4 with time 2.25
Client 5 trained with time 12.39
Mask generated for client 5 with time 2.63
Client 6 trained with time 12.67
Mask generated for client 6 with time 2.79
Client 7 trained with time 13.29
Mask generated for client 7 with time 2.82
Client 8 trained with time 12.85
Mask generated for client 8 with time 2.90
Client 9 trained with time 12.44
Mask generated for client 9 with time 2.86
Masks aggregated with time 18.67
Update generated with time 59.65
Update aggregated with time: 5.64
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Modi he_rate: 0.08590683010253906
Model distributed with time: 30.14
Round 6 Loss: 2.2984, Acc: 0.2741
Client 0 trained with time 12.45
Mask generated for client 0 with time 2.83
Client 1 trained with time 12.17
Mask generated for client 1 with time 2.22
Client 2 trained with time 11.45
Mask generated for client 2 with time 2.00
Client 3 trained with time 10.86
Mask generated for client 3 with time 2.07
Client 4 trained with time 10.91
Mask generated for client 4 with time 1.73
Client 5 trained with time 10.52
Mask generated for client 5 with time 1.64
Client 6 trained with time 10.68
Mask generated for client 6 with time 1.53
Client 7 trained with time 10.51
Mask generated for client 7 with time 1.62
Client 8 trained with time 10.50
Mask generated for client 8 with time 1.67
Client 9 trained with time 10.93
Mask generated for client 9 with time 1.62
Masks aggregated with time 14.45
Update generated with time 57.24
Update aggregated with time: 5.82
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Modi he_rate: 0.08375915934997559
Model distributed with time: 30.24
Round 7 Loss: 2.5274, Acc: 0.2591
Client 0 trained with time 12.28
Mask generated for client 0 with time 2.00
Client 1 trained with time 12.10
Mask generated for client 1 with time 2.10
Client 2 trained with time 12.05
Mask generated for client 2 with time 2.08
Client 3 trained with time 12.60
Mask generated for client 3 with time 2.65
Client 4 trained with time 11.59
Mask generated for client 4 with time 2.16
Client 5 trained with time 11.54
Mask generated for client 5 with time 2.01
Client 6 trained with time 11.85
Mask generated for client 6 with time 1.97
Client 7 trained with time 11.81
Mask generated for client 7 with time 2.29
Client 8 trained with time 12.65
Mask generated for client 8 with time 2.15
Client 9 trained with time 12.20
Mask generated for client 9 with time 2.21
Masks aggregated with time 17.47
Update generated with time 58.95
Update aggregated with time: 5.60
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Modi he_rate: 0.08166518036622619
Model distributed with time: 29.95
